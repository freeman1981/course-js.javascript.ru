{"version":3,"sources":["webpack:///./src/components/categories/index.js","webpack:///./src/pages/categories/index.js","webpack:///./src/utils/fetch-json.js","webpack:///./src/utils/escape-html.js","webpack:///./src/components/sortable-list/index.js","webpack:///./src/components/notification/index.js"],"names":["Categories","constructor","data","event","preventDefault","target","isHeader","classList","contains","parentDiv","closest","toggle","async","children","payload","map","child","index","id","dataset","weight","this","send","showNotificationMessage","type","error","duration","render","message","NotificationMessage","show","url","URL","process","requestParams","method","headers","body","JSON","stringify","fetchJson","wrapper","document","createElement","innerHTML","getCategoriesContainerTemplate","element","firstElementChild","appendSubcategoryDraggableList","initEventListeners","addEventListener","toggleAccordion","onSortableListReorder","removeEventListeners","removeEventListener","getCategoryTemplate","item","escapeHtml","title","join","createSubcategoryList","subcategories","count","getSortableListItemTemplate","subcategotyListArr","querySelectorAll","forEach","subcategoryElement","sortableList","SortableList","items","append","remove","destroy","Page","fetchUrl","searchParams","set","initComponents","categories","components","template","subElements","getSubElements","getData","renderComponents","Object","keys","component","root","reduce","accum","subElement","values","params","response","fetch","toString","err","FetchError","ok","errorText","statusText","json","status","Error","super","window","reason","alert","string","replace","clientX","clientY","moveDraggingAt","top","firstElementTop","getBoundingClientRect","bottom","movePlaceholderAt","length","i","li","draggingElem","offsetHeight","height","scrollIfCloseToWindowEdge","dragStop","className","addItems","onPointerDown","add","which","itemElem","dragStart","elementInitialIndex","indexOf","pointerInitialShift","x","y","placeholderElem","style","width","offsetWidth","after","onDocumentPointerMove","onDocumentPointerUp","left","scrollBy","documentElement","clientHeight","currentElement","insertBefore","placeholderIndex","replaceWith","dispatchEvent","CustomEvent","bubbles","detail","from","to","activeComponent","parent","setTimeout"],"mappings":"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","file":"categories-index-js-1.js","sourcesContent":["import escapeHtml from '../../utils/escape-html.js';\nimport fetchJson from '../../utils/fetch-json.js';\nimport SortableList from '../../components/sortable-list/index.js';\nimport NotificationMessage from '../../components/notification/index.js';\n\nexport default class Categories {\n\n  element; //html element\n\n  toggleAccordion = (event) => {\n    event.preventDefault();\n    const {target} = event;\n    const isHeader = target.classList.contains(\"category__header\");\n    const parentDiv = target.closest(\"div\");\n\n    if (isHeader) {\n      parentDiv.classList.toggle(\"category_open\");\n    }\n  }\n\n  onSortableListReorder = async (event) => {\n    const { target } = event;\n    const { children } = target;\n\n    const payload = [...children].map((child, index) => {\n      const { id } = child.dataset;\n\n      return {\n        id,\n        weight: index\n      };\n    });\n\n    try {\n      await this.send(payload);\n      this.showNotificationMessage(\"Category order saved\", {type: \"success\"});\n    } catch (error) {\n      this.showNotificationMessage(`Server side error! ${error}`, {type: \"error\", duration: 3000});\n    }\n  }\n\n  constructor(data) {\n    this.data = data;\n    this.render();\n  }\n\n  showNotificationMessage(message, {duration = 2000, type} = {}) {\n    const notificationMessage = new NotificationMessage(message, {\n      duration: duration,\n      type: type\n    });\n    notificationMessage.show();\n  }\n\n  async send(payload) {\n    const url = new URL ('api/rest/subcategories', process.env.BACKEND_URL);\n    const requestParams = {\n      method: 'PATCH',\n      headers:             {\n        'Content-Type': 'application/json;charset=utf-8'\n      },\n      body: JSON.stringify(payload)\n    }\n\n    await fetchJson(url, requestParams);\n  }\n\n  render() {\n    const wrapper = document.createElement('div');\n\n    wrapper.innerHTML = this.getCategoriesContainerTemplate(this.data);\n\n    const element = wrapper.firstElementChild;\n\n    this.element = element;\n\n    this.appendSubcategoryDraggableList();\n\n    this.initEventListeners();\n  }\n\n  initEventListeners() {\n    this.element.addEventListener(\"click\", this.toggleAccordion);\n    this.element.addEventListener(\"sortable-list-reorder\", this.onSortableListReorder);\n  }\n\n  removeEventListeners() {\n    this.element.removeEventListener(\"click\", this.toggleAccordion);\n    this.element.removeEventListener(\"sortable-list-reorder\", this.onSortableListReorder);\n  }\n\n  getCategoriesContainerTemplate(data) {\n    return `\n      <div data-element=\"categoriesContainer\">\n        ${this.getCategoryTemplate(data)}\n      </div>\n    `;\n  }\n\n  getCategoryTemplate(data) {\n    return data\n      .map(item => {\n        return `\n          <div class=\"category category_open\" data-id=\"${item.id}\">\n            <header class=\"category__header\">${escapeHtml(item.title)}</header>\n            <div class=\"category__body\">\n              <div class=\"subcategory-list\" data-element=\"subcategoryList\">\n              </div>\n            </div>\n          </div>\n        `;\n      }).join(\"\");\n  }\n\n  createSubcategoryList() {\n    return this.data\n      .map(element => {\n        const { subcategories } = element;\n        const items = subcategories.map(({ id, title, count }) => this.getSortableListItemTemplate(id, title, count));\n        return items;\n      });\n  }\n\n  getSortableListItemTemplate(id, title, count) {\n    const wrapper = document.createElement('div');\n\n    wrapper.innerHTML = `\n      <li class=\"categories__sortable-list-item sortable-list__item\" data-grab-handle=\"\" data-id=\"${id}\">\n        <strong>${escapeHtml(title)}</strong>\n        <span><b>${count}</b> products</span>\n      </li>`;\n\n    return wrapper.firstElementChild;\n  }\n\n  appendSubcategoryDraggableList() {\n    const subcategotyListArr = this.createSubcategoryList();\n    const subcategoryElementArr = this.element.querySelectorAll(\"[data-element='subcategoryList']\");\n\n    subcategoryElementArr.forEach((subcategoryElement, index) => {\n      const sortableList = new SortableList({ items: subcategotyListArr[index] });\n\n      subcategoryElement.append(sortableList.element);\n    });\n  }\n\n  remove() {\n    this.element.remove();\n  }\n\n  destroy() {\n    this.removeEventListeners();\n    this.remove();\n  }\n}","import Categories from '../../components/categories/index.js';\nimport fetchJson from '../../utils/fetch-json.js';\n\nconst BACKEND_URL = process.env.BACKEND_URL;\nconst CATEGORIES_URL = \"api/rest/categories\";\n\nexport default class Page {\n  element;\n  subElements = {};\n  components = {};\n  data = {};\n\n  async getData () {\n    const fetchUrl = new URL(CATEGORIES_URL, BACKEND_URL);\n    fetchUrl.searchParams.set(\"_sort\", \"weight\");\n    fetchUrl.searchParams.set(\"_refs\", \"subcategory\");\n    this.data = await fetchJson(fetchUrl);\n  }\n\n  initComponents () {\n\n    const categories = new Categories(this.data);\n    this.components.categories = categories;\n  }\n\n  get template () {\n    return `\n    <div class=\"categories\">\n      <div class=\"content__top-panel\">\n        <h1 class=\"page-title\">Категории товаров</h1>\n      </div>\n      <div data-element=\"categories\">\n        <!-- categories component -->\n      </div>\n    </div>`;\n  }\n\n  async render () {\n    const element = document.createElement('div');\n\n    element.innerHTML = this.template;\n\n    this.element = element.firstElementChild;\n    \n    this.subElements = this.getSubElements(this.element);\n\n    await this.getData();\n\n    this.initComponents();\n\n    this.renderComponents();\n\n    return this.element;\n  }\n\n  renderComponents () {\n    Object.keys(this.components).forEach(component => {\n      const root = this.subElements[component];\n      const { element } = this.components[component];\n      root.append(element);\n    });\n  }\n\n  getSubElements (element) {\n    const elements = element.querySelectorAll('[data-element]');\n\n    return [...elements].reduce((accum, subElement) => {\n      accum[subElement.dataset.element] = subElement;\n\n      return accum;\n    }, {});\n  }\n\n  destroy () {\n    for (const component of Object.values(this.components)) {\n      component.destroy();\n    }\n  }\n}\n","// same as fetch, but throws FetchError in case of errors\n// status >= 400 is an error\n// network error / json error are errors\n\nexport default async function(url, params) {\n  let response;\n\n  try {\n    // NOTE: \"toString\" call needed for correct work of \"jest-fetch-mock\"\n    response = await fetch(url.toString(), params);\n  } catch(err) {\n    throw new FetchError(response, \"Network error has occurred.\");\n  }\n\n  let body;\n\n  if (!response.ok) {\n    let errorText = response.statusText; // Not Found (for 404)\n\n    try {\n      body = await response.json();\n\n      errorText = (body.error && body.error.message) || (body.data && body.data.error && body.data.error.message) || errorText;\n    } catch (error) { /* ignore failed body */ }\n\n    let message = `Error ${response.status}: ${errorText}`;\n\n    throw new FetchError(response, body, message);\n  }\n\n  try {\n    return await response.json();\n  } catch(err) {\n    throw new FetchError(response, null, err.message);\n  }\n}\n\nexport class FetchError extends Error {\n  name = \"FetchError\";\n\n  constructor(response, body, message) {\n    super(message);\n    this.response = response;\n    this.body = body;\n  }\n}\n\n// handle uncaught failed fetch through\nwindow.addEventListener('unhandledrejection', event => {\n  if (event.reason instanceof FetchError) {\n    alert(event.reason.message);\n  }\n});\n\n","export default string => string\n  .replace(/&/g, '&amp;')\n  .replace(/\"/g, '&quot;')\n  .replace(/'/g, '&#39;')\n  .replace(/</g, '&lt;')\n  .replace(/>/g, '&gt;');\n","export default class SortableList {\n  element;\n\n  onDocumentPointerMove = ({clientX, clientY}) => {\n    this.moveDraggingAt(clientX, clientY);\n\n    const {firstElementChild, children} = this.element;\n    const {top: firstElementTop} = firstElementChild.getBoundingClientRect();\n    const {bottom} = this.element.getBoundingClientRect();\n\n    if (clientY < firstElementTop) {\n      this.movePlaceholderAt(0);\n    } else if (clientY > bottom) {\n      this.movePlaceholderAt(children.length);\n    } else {\n      for (let i = 0; i < children.length; i++) {\n        const li = children[i];\n\n        if (li !== this.draggingElem) {\n          const {top, bottom} = li.getBoundingClientRect();\n          const {offsetHeight: height} = li;\n\n          if (clientY > top && clientY < bottom) {\n            if (clientY < top + height / 2) {\n              this.movePlaceholderAt(i);\n              break;\n            } else {\n              this.movePlaceholderAt(i + 1);\n              break;\n            }\n          }\n        }\n      }\n    }\n\n    this.scrollIfCloseToWindowEdge(clientY);\n  };\n\n  onDocumentPointerUp = () => {\n    this.dragStop();\n  };\n\n  constructor({items = []} = {}) {\n    this.items = items;\n\n    this.render();\n  }\n\n  render() {\n    this.element = document.createElement('ul');\n    this.element.className = 'sortable-list';\n\n    this.addItems();\n    this.initEventListeners();\n  }\n\n  initEventListeners() {\n    this.element.addEventListener('pointerdown', event => this.onPointerDown(event));\n  }\n\n  addItems() {\n    for (let item of this.items) {\n      item.classList.add('sortable-list__item');\n    }\n\n    this.element.append(...this.items);\n  }\n\n  onPointerDown(event) {\n    if (event.which !== 1) { // must be left-button\n      return false;\n    }\n\n    const itemElem = event.target.closest('.sortable-list__item');\n\n    if (itemElem) {\n      if (event.target.closest('[data-grab-handle]')) {\n        event.preventDefault();\n\n        this.dragStart(itemElem, event);\n      }\n\n      if (event.target.closest('[data-delete-handle]')) {\n        event.preventDefault();\n\n        itemElem.remove();\n      }\n    }\n  }\n\n  dragStart(itemElem, {clientX, clientY}) {\n    this.elementInitialIndex = [...this.element.children].indexOf(itemElem);\n\n    this.pointerInitialShift = {\n      x: clientX - itemElem.getBoundingClientRect().x,\n      y: clientY - itemElem.getBoundingClientRect().y\n    };\n\n    this.draggingElem = itemElem;\n\n    this.placeholderElem = document.createElement('li');\n    this.placeholderElem.className = 'sortable-list__placeholder';\n\n    itemElem.style.width = `${itemElem.offsetWidth}px`;\n    itemElem.style.height = `${itemElem.offsetHeight}px`;\n\n    this.placeholderElem.style.width = itemElem.style.width;\n    this.placeholderElem.style.height = itemElem.style.height;\n\n    itemElem.classList.add('sortable-list__item_dragging');\n\n    itemElem.after(this.placeholderElem);\n\n    this.element.append(itemElem);\n\n    this.moveDraggingAt(clientX, clientY);\n\n    document.addEventListener('pointermove', this.onDocumentPointerMove);\n    document.addEventListener('pointerup', this.onDocumentPointerUp);\n  }\n\n  moveDraggingAt(clientX, clientY) {\n    this.draggingElem.style.left = clientX - this.pointerInitialShift.x + 'px';\n    this.draggingElem.style.top = clientY - this.pointerInitialShift.y + 'px';\n  }\n\n  scrollIfCloseToWindowEdge(clientY) {\n    const scrollingValue = 10;\n    const threshold = 20;\n\n    if (clientY < threshold) {\n      window.scrollBy(0, -scrollingValue);\n    } else if (clientY > document.documentElement.clientHeight - threshold) {\n      window.scrollBy(0, scrollingValue);\n    }\n  }\n\n  movePlaceholderAt(index) {\n    const currentElement = this.element.children[index];\n\n    if (currentElement !== this.placeholderElem) {\n      this.element.insertBefore(this.placeholderElem, currentElement);\n    }\n  }\n\n  dragStop() {\n    const placeholderIndex = [...this.element.children].indexOf(this.placeholderElem);\n\n    this.placeholderElem.replaceWith(this.draggingElem);\n    this.draggingElem.classList.remove('sortable-list__item_dragging');\n\n    this.draggingElem.style.left = '';\n    this.draggingElem.style.top = '';\n    this.draggingElem.style.width = '';\n    this.draggingElem.style.height = '';\n\n    document.removeEventListener('pointermove', this.onDocumentPointerMove);\n    document.removeEventListener('pointerup', this.onDocumentPointerUp);\n\n    this.draggingElem = null;\n\n    if (placeholderIndex !== this.elementInitialIndex) {\n      this.element.dispatchEvent(new CustomEvent('sortable-list-reorder', {\n        bubbles: true,\n        detail: {\n          from: this.elementInitialIndex,\n          to: placeholderIndex\n        }\n      }));\n    }\n  }\n\n  remove() {\n    this.element.remove();\n    document.removeEventListener('pointermove', this.onDocumentPointerMove);\n    document.removeEventListener('pointerup', this.onDocumentPointerUp);\n  }\n\n  destroy() {\n    this.remove();\n  }\n}","export default class NotificationMessage {\n  static activeComponent;\n\n  element; // HTMLElement;\n\n  constructor(\n    message, \n    {\n      duration,\n      type\n    } = {}) {\n    this.message = message;\n    this.duration = duration;\n    this.type = type;\n    \n    this.render();\n  }\n\n  get template() {\n    return `\n      <div class=\"notification notification_${this.type} show\" style=\"--value:${this.duration / 1000}s\">\n        <div class=\"notification__content\">\n          ${this.message}\n        </div>\n      </div>\n    `;\n  }\n\n  render() {\n\n    if (NotificationMessage.activeComponent) {\n      NotificationMessage.activeComponent.remove();\n    }\n\n    const element = document.createElement('div');\n    element.innerHTML = this.template;\n    this.element = element.firstElementChild;\n    NotificationMessage.activeComponent = this.element;\n  }\n\n  show(parent = document.body) {\n    parent.append(this.element);\n\n    setTimeout(() => {\n      this.remove();\n    }, this.duration);\n  }\n\n  remove() {\n    this.element.remove();\n  }\n\n  destroy() {\n    this.remove();\n  }\n}"],"sourceRoot":""}